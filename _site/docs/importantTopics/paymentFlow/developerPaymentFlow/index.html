<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="shortcut icon" href="/Guide/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/Guide/assets/css/pi-new_dev_onboarding-default.css"> <script type="text/javascript" src="/Guide/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/Guide/assets/js/pi-new_dev_onboarding.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Developer Payment Flow | Pi Developer Guide</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Developer Payment Flow" /><meta property="og:locale" content="en_US" /><meta name="description" content="A guide for developers to build on Pi" /><meta property="og:description" content="A guide for developers to build on Pi" /><link rel="canonical" href="http://localhost:4000/Guide/docs/importantTopics/paymentFlow/developerPaymentFlow/" /><meta property="og:url" content="http://localhost:4000/Guide/docs/importantTopics/paymentFlow/developerPaymentFlow/" /><meta property="og:site_name" content="Pi Developer Guide" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Developer Payment Flow" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"A guide for developers to build on Pi","headline":"Developer Payment Flow","url":"http://localhost:4000/Guide/docs/importantTopics/paymentFlow/developerPaymentFlow/"}</script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="http://localhost:4000/Guide/" class="site-title lh-tight"> Pi Developer Guide </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/Guide/" class="nav-list-link">Welcome</a><li class="nav-list-item"><a href="http://localhost:4000/Guide/docs/communitySupport/" class="nav-list-link">Community Support</a><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/Guide/docs/gettingStarted/" class="nav-list-link">Getting Started</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/Guide/docs/gettingSetup/piBrowserIntroduction/" class="nav-list-link">Pi Browser Introduction</a><li class="nav-list-item "><a href="http://localhost:4000/Guide/docs/gettingSetup/devPortal/" class="nav-list-link">Developer Portal</a><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/Guide/docs/gettingSetup/piPlatform/" class="nav-list-link">Pi Platform</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/Guide/docs/gettingSetup/piPlatform/piSDK/" class="nav-list-link">Pi Platform SDK</a><li class="nav-list-item "> <a href="http://localhost:4000/Guide/docs/gettingSetup/piPlatform/videoIntegrationPiSDK/" class="nav-list-link">Video Ingtegration Pi SDK</a><li class="nav-list-item "> <a href="http://localhost:4000/Guide/docs/gettingSetup/piPlatform/piAPIs/" class="nav-list-link">Pi Platform APIs</a></ul></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/Guide/docs/importantTopics/" class="nav-list-link">Important Topics</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/Guide/docs/importantTopics/mainnetVsTestnet/" class="nav-list-link">Pi Mainnet vs Pi Testnet</a><li class="nav-list-item "><a href="http://localhost:4000/Guide/docs/importantTopics/accessToken/" class="nav-list-link">Access Token</a><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/Guide/docs/importantTopics/paymentFlow/" class="nav-list-link">Pi Payments</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/Guide/docs/importantTopics/paymentFlow/piWallet/" class="nav-list-link">Pi Wallet Intro</a><li class="nav-list-item active"> <a href="http://localhost:4000/Guide/docs/importantTopics/paymentFlow/developerPaymentFlow/" class="nav-list-link active">Developer Payment Flow</a><li class="nav-list-item "> <a href="http://localhost:4000/Guide/docs/importantTopics/paymentFlow/pioneerToApp/" class="nav-list-link">Pioneer to App Payments</a><li class="nav-list-item "> <a href="http://localhost:4000/Guide/docs/importantTopics/paymentFlow/pioneerToAppPaymentVideo/" class="nav-list-link">Video Integration - Pioneer to App Payments</a></ul></ul></ul></nav></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Pi Developer Guide" aria-label="Search Pi Developer Guide" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="https://github.com/pi-apps/pi-platform-docs" class="site-button" > Pi Platform Github Docs </a></ul></nav></div><div id="main-content-wrap" class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/Guide/docs/importantTopics/">Important Topics</a><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/Guide/docs/importantTopics/paymentFlow/">Pi Payments</a><li class="breadcrumb-nav-list-item"><span>Developer Payment Flow</span></ol></nav><div id="main-content" class="main-content" role="main"><h1 class="no_toc" id="pi-payments"> <a href="#pi-payments" class="anchor-heading" aria-labelledby="pi-payments"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pi Payments</h1><p class="fs-6 fw-300">The platform API allows you to read and write data to the Pi Servers related with your app deployed on the Pi App Platform, and your app’s Pioneers.</p><h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents</h2><ol id="markdown-toc"><li><a href="#what-are-pi-payments" id="markdown-toc-what-are-pi-payments">What are Pi Payments</a><li><a href="#payment-flow-diagram" id="markdown-toc-payment-flow-diagram">Payment Flow Diagram</a><li><a href="#payment-flow-steps" id="markdown-toc-payment-flow-steps">Payment Flow Steps</a><ol><li><a href="#phase-i---payment-creation-and-server-side-approval" id="markdown-toc-phase-i---payment-creation-and-server-side-approval">Phase I - Payment creation and Server-Side Approval</a><li><a href="#phase-ii---pioneer-interaction-and-blockchain-transaction" id="markdown-toc-phase-ii---pioneer-interaction-and-blockchain-transaction">Phase II - Pioneer interaction and blockchain transaction</a><li><a href="#phase-iii---server-side-completion" id="markdown-toc-phase-iii---server-side-completion">Phase III - Server-Side Completion</a></ol><li><a href="#app-payment-security" id="markdown-toc-app-payment-security">App Payment Security</a></ol><hr /><h2 id="what-are-pi-payments"> <a href="#what-are-pi-payments" class="anchor-heading" aria-labelledby="what-are-pi-payments"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What are Pi Payments</h2><p>Payments are wrappers around blockchain transactions, which enable your app, the Pi blockchain, and the Pi Servers to be all synchronized when the Pioneer submits a blockchain transaction to pay for something in your app.</p><p>They enable you, the developer of the app, to have full confidence that the Pioneer has actually made the transaction, while not having to bother with the technicalities involved when interacting with the Pi blockchain. The Payment flow</p><p>After they’re created, payments go through 3 major phases:</p><ol><li> Payment creation and Server-Side Approval<li> Pioneer interaction and blockchain transaction<li> Server-Side Completion</ol><h2 id="payment-flow-diagram"> <a href="#payment-flow-diagram" class="anchor-heading" aria-labelledby="payment-flow-diagram"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Payment Flow Diagram</h2><p>The below diagram outlines the steps involved in a Pioneer to App payment.</p><p><img title="Pi Payment Flow" alt="Pi Payment Flow Diagram" src="/assets/images/wBackground_pi_payment_flow_diagram.png" /></p><h2 id="payment-flow-steps"> <a href="#payment-flow-steps" class="anchor-heading" aria-labelledby="payment-flow-steps"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Payment Flow Steps</h2><h3 id="phase-i---payment-creation-and-server-side-approval"> <a href="#phase-i---payment-creation-and-server-side-approval" class="anchor-heading" aria-labelledby="phase-i---payment-creation-and-server-side-approval"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Phase I - Payment creation and Server-Side Approval</h3><ul><li>1. createPayment: Your app's frontend creates the payment. The Payment Flow UI opens, but cannot be interacted with until the payment is approved by your server.<li>2. onReadyForServerApproval: The JS SDK has obtained the payment identifier (PaymentID) and is passing it to your app for Server-Side approval.<ul><li> Your app's frontend sends the PaymentID to your app's server. This implementation is your responsibility.</ul><li>3. Server-Side Approval: Your app's server approves the payment with Pi Servers through the /approve API call. This enables the Pioneer to submit the blockchain transaction.</ul><h3 id="phase-ii---pioneer-interaction-and-blockchain-transaction"> <a href="#phase-ii---pioneer-interaction-and-blockchain-transaction" class="anchor-heading" aria-labelledby="phase-ii---pioneer-interaction-and-blockchain-transaction"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Phase II - Pioneer interaction and blockchain transaction</h3><p>Steps 4a and 4b on the Pi Payment Flow Diagram.</p><p>At this stage, the payment dialog becomes interactive and enables the Pioneer to confirm the transaction, sign it, and submit it to the Pi blockchain.</p><p>You do not have anything to do at this stage, everything is handled by the Pi Apps Platform and the Pi Wallet.</p><p>After the blockchain transaction is submitted, the payment flow will not close. You need to acknowledge the payment through Server-Side completion before your app is visible again.</p><h3 id="phase-iii---server-side-completion"> <a href="#phase-iii---server-side-completion" class="anchor-heading" aria-labelledby="phase-iii---server-side-completion"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Phase III - Server-Side Completion</h3><ul><li>5. onReadyForServerCompletion: The Pi Servers will submit the Pioneer approved transaction to the Blockchain. Then Pi SDK passes the blockchain transaction identifier (TxID) to your app's frontend, through the callback function onReadyForServerCompletion. You need this value for the Server-Side Completion flow which uses the TxID in the Pi API call.<ul><li> Your app's frontend sends the TxID to your app's server. This implementation is your responsibility.</ul><li>6. Server-Side Completion: Your app's server acknowledges the payment with the Pi Servers through the /complete API endpoint. This enables you to check whether the blockchain transaction has actually happened, and to let Pi know that you're aware of it.<li>7. The payment flow closes. Your app is now visible to the Pioneer again. Your app's server and your app's frontend can exchange data, and update the app interface to show a confirmation screen to the Pioneer.<ul><li> This implementation is your responsibility.</ul></ul><h2 id="app-payment-security"> <a href="#app-payment-security" class="anchor-heading" aria-labelledby="app-payment-security"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> App Payment Security</h2><p>Do not complete any payment within your app until the payment has completed and had a paymentDTO returned from the /complete API endpoint of the Server-Side Completion. The Pioneer might be lying to your app, by running a hacked version of the SDK the Pioneer could pretend they have made a payment. If the API call to <code class="language-plaintext highlighter-rouge">/payment/{ transaction_id }/complete</code> returns a non-200 error code, do not mark the payment complete or paid with your app.</p><hr><footer><p><a href="#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2017-2020 Patrick Marsceill. Distributed by an <a href="https://github.com/just-the-docs/just-the-docs/tree/main/LICENSE.txt">MIT license.</a></p><div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/pi-apps/pi-platform-docs/tree/main/docs/importantTopics/paymentFlow/developerPaymentFlow.md" id="edit-this-page">Edit this page on GitHub</a></p></div></footer></div></div><div class="search-overlay"></div></div>
